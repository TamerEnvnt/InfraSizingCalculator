@*
    LimitedExportModal.razor - v0.4.2 wireframe design
    Export modal with limited options for guest users
    Only PDF summary export available, other formats require sign-in
*@

@if (IsVisible)
{
    <div class="modal-overlay" @onclick="Close">
        <div class="modal" @onclick:stopPropagation="true">
            <div class="modal-header">
                <h2 class="modal-title">Export Report</h2>
                <button class="close-btn" @onclick="Close">X</button>
            </div>

            <div class="modal-body">
                <!-- Format Selection -->
                <div class="section">
                    <h3 class="section-title">Export Format</h3>
                    <div class="format-grid">
                        <div class="format-card selected">
                            <div class="format-icon">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <polyline points="14 2 14 8 20 8"/>
                                    <line x1="16" y1="13" x2="8" y2="13"/>
                                    <line x1="16" y1="17" x2="8" y2="17"/>
                                    <polyline points="10 9 9 9 8 9"/>
                                </svg>
                            </div>
                            <div class="format-name">PDF</div>
                            <div class="format-desc">Summary report</div>
                        </div>
                        <div class="format-card disabled">
                            <span class="format-badge">PRO</span>
                            <div class="format-icon">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <path d="M14 2v6h6"/>
                                    <path d="M8 13h2"/>
                                    <path d="M8 17h2"/>
                                    <path d="M14 13h2"/>
                                    <path d="M14 17h2"/>
                                </svg>
                            </div>
                            <div class="format-name">Excel</div>
                            <div class="format-desc">Full data export</div>
                        </div>
                        <div class="format-card disabled">
                            <span class="format-badge">PRO</span>
                            <div class="format-icon">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <path d="M14 2v6h6"/>
                                    <path d="M10 12l-2 4h4l-2 4"/>
                                </svg>
                            </div>
                            <div class="format-name">JSON</div>
                            <div class="format-desc">Machine-readable</div>
                        </div>
                    </div>
                </div>

                <!-- Content Options -->
                <div class="section">
                    <h3 class="section-title">Include in Export</h3>
                    <div class="options-list">
                        <div class="option-row">
                            <div class="checkbox checked"></div>
                            <div class="option-info">
                                <div class="option-label">Summary Overview</div>
                                <div class="option-desc">Key metrics and totals</div>
                            </div>
                        </div>
                        <div class="option-row disabled">
                            <div class="checkbox disabled"></div>
                            <div class="option-info">
                                <div class="option-label">Node Details</div>
                                <div class="option-desc">Specifications for each node type</div>
                            </div>
                            <span class="option-badge">Sign In</span>
                        </div>
                        <div class="option-row disabled">
                            <div class="checkbox disabled"></div>
                            <div class="option-info">
                                <div class="option-label">Cost Breakdown</div>
                                <div class="option-desc">Detailed pricing by component</div>
                            </div>
                            <span class="option-badge">Sign In</span>
                        </div>
                        <div class="option-row disabled">
                            <div class="checkbox disabled"></div>
                            <div class="option-info">
                                <div class="option-label">Growth Projections</div>
                                <div class="option-desc">Future capacity estimates</div>
                            </div>
                            <span class="option-badge">Sign In</span>
                        </div>
                    </div>
                </div>

                <!-- Upgrade Prompt -->
                <div class="section">
                    <div class="upgrade-prompt">
                        <div class="upgrade-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                                <path d="M2 17l10 5 10-5"/>
                                <path d="M2 12l10 5 10-5"/>
                            </svg>
                        </div>
                        <div class="upgrade-text">
                            <h4>Unlock Full Export</h4>
                            <p>Sign in to export detailed reports with full node specs, cost breakdowns, and growth projections.</p>
                        </div>
                        <a href="/login" class="upgrade-btn">Sign In</a>
                    </div>
                </div>

                <!-- Preview -->
                <div class="section">
                    <h3 class="section-title">Preview</h3>
                    <div class="preview-box">
                        <div class="preview-header">
                            <span class="preview-title">Summary Export</span>
                            <span class="preview-size">~8 KB</span>
                        </div>
                        <div class="preview-content">
Infrastructure Sizing Summary
----------------------------
Total Nodes: @TotalNodes
Total vCPUs: @TotalCPU
Total RAM: @TotalRAM GB
Monthly Cost: @MonthlyEstimate

Platform: @Platform
Technology: @Technology
                        </div>
                        <div class="preview-watermark">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="12" y1="8" x2="12" y2="12"/>
                                <line x1="12" y1="16" x2="12.01" y2="16"/>
                            </svg>
                            Guest export includes watermark. Sign in for clean exports.
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <div class="footer-info">
                    Summary only (1 section)
                </div>
                <div class="footer-buttons">
                    <button class="btn btn-secondary" @onclick="Close">Cancel</button>
                    <button class="btn btn-primary" @onclick="DownloadSummary">
                        Download Summary
                    </button>
                </div>
            </div>
        </div>
    </div>
}

@code {
    [Parameter]
    public bool IsVisible { get; set; }

    [Parameter]
    public EventCallback<bool> IsVisibleChanged { get; set; }

    [Parameter]
    public int TotalNodes { get; set; }

    [Parameter]
    public double TotalCPU { get; set; }

    [Parameter]
    public double TotalRAM { get; set; }

    [Parameter]
    public string MonthlyEstimate { get; set; } = "$0";

    [Parameter]
    public string Platform { get; set; } = "Kubernetes";

    [Parameter]
    public string Technology { get; set; } = "Native";

    [Parameter]
    public EventCallback OnDownload { get; set; }

    private async Task Close()
    {
        IsVisible = false;
        await IsVisibleChanged.InvokeAsync(false);
    }

    private async Task DownloadSummary()
    {
        await OnDownload.InvokeAsync();
        await Close();
    }
}
