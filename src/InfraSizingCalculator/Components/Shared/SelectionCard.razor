@* Reusable selection card component for wizard steps *@

<div class="selection-card @(IsSelected ? "selected" : "") @AdditionalClass"
     style="@(BrandColor != null ? $"--brand-color: {BrandColor}" : "")"
     @onclick="OnClick"
     @onkeydown="HandleKeyDown"
     role="option"
     aria-selected="@IsSelected.ToString().ToLowerInvariant()"
     tabindex="0">
    @if (!string.IsNullOrEmpty(Icon))
    {
        <span class="card-icon" aria-hidden="true">@Icon</span>
    }
    <div class="card-content">
        <span class="card-title">@Title</span>
        @if (!string.IsNullOrEmpty(Subtitle))
        {
            <span class="card-subtitle">@Subtitle</span>
        }
        @if (!string.IsNullOrEmpty(Description))
        {
            <span class="card-desc">@Description</span>
        }
        @if (Tags != null && Tags.Any())
        {
            <div class="card-tags" aria-label="Tags">
                @foreach (var tag in Tags)
                {
                    <span class="tag @tag.CssClass">@tag.Label</span>
                }
            </div>
        }
    </div>
    @if (IsSelected)
    {
        <span class="check-mark icon icon-check" aria-hidden="true"></span>
        <span class="visually-hidden">Selected</span>
    }
</div>

@code {
    [Parameter] public string? Icon { get; set; }
    [Parameter] public string Title { get; set; } = "";
    [Parameter] public string? Subtitle { get; set; }
    [Parameter] public string? Description { get; set; }
    [Parameter] public bool IsSelected { get; set; }
    [Parameter] public string? BrandColor { get; set; }
    [Parameter] public string? AdditionalClass { get; set; }
    [Parameter] public IEnumerable<TagInfo>? Tags { get; set; }
    [Parameter] public EventCallback OnClick { get; set; }

    private async Task HandleKeyDown(KeyboardEventArgs e)
    {
        // Activate on Enter or Space (WCAG 2.1 keyboard accessibility)
        if ((e.Key == "Enter" || e.Key == " ") && OnClick.HasDelegate)
        {
            await OnClick.InvokeAsync();
        }
    }

    public record TagInfo(string CssClass, string Label);
}
