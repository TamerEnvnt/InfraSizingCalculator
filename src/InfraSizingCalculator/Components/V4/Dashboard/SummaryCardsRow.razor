@*
    SummaryCardsRow.razor - Horizontal row of key metric summary cards

    Features:
    - 4-5 metric cards in a responsive grid
    - Each card shows: icon, value, label, optional delta
    - Animated value changes
    - Click to scroll to related section
*@

<div class="summary-cards-row" data-testid="summary-cards-row">
    @foreach (var card in Cards)
    {
        <div class="summary-card @(card.IsHighlighted ? "highlighted" : "")"
             @onclick="() => HandleCardClick(card.Id)"
             data-testid="summary-card-@card.Id">
            <div class="card-icon @card.IconColor">
                @((MarkupString)card.IconSvg)
            </div>
            <div class="card-content">
                <div class="card-value">
                    @if (card.Prefix != null)
                    {
                        <span class="value-prefix">@card.Prefix</span>
                    }
                    <span class="value-main">@card.Value</span>
                    @if (card.Suffix != null)
                    {
                        <span class="value-suffix">@card.Suffix</span>
                    }
                </div>
                <div class="card-label">@card.Label</div>
                @if (card.Delta != null)
                {
                    <div class="card-delta @(card.DeltaPositive ? "positive" : "negative")">
                        @if (card.DeltaPositive)
                        {
                            <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 4l8 8h-6v8h-4v-8H4l8-8z"/>
                            </svg>
                        }
                        else
                        {
                            <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 20l-8-8h6V4h4v8h6l-8 8z"/>
                            </svg>
                        }
                        @card.Delta
                    </div>
                }
            </div>
        </div>
    }
</div>

@code {
    /// <summary>
    /// List of summary cards to display
    /// </summary>
    [Parameter]
    public List<SummaryCard> Cards { get; set; } = new();

    /// <summary>
    /// Callback when a card is clicked
    /// </summary>
    [Parameter]
    public EventCallback<string> OnCardClick { get; set; }

    private async Task HandleCardClick(string cardId)
    {
        await OnCardClick.InvokeAsync(cardId);
    }

    /// <summary>
    /// Summary card data model
    /// </summary>
    public class SummaryCard
    {
        public string Id { get; set; } = string.Empty;
        public string IconSvg { get; set; } = string.Empty;
        public string IconColor { get; set; } = "blue";
        public string? Prefix { get; set; }
        public string Value { get; set; } = "0";
        public string? Suffix { get; set; }
        public string Label { get; set; } = string.Empty;
        public string? Delta { get; set; }
        public bool DeltaPositive { get; set; }
        public bool IsHighlighted { get; set; }

        public SummaryCard() { }

        public SummaryCard(string id, string label, string value, string iconSvg, string iconColor = "blue")
        {
            Id = id;
            Label = label;
            Value = value;
            IconSvg = iconSvg;
            IconColor = iconColor;
        }
    }

    /// <summary>
    /// Common SVG icons for summary cards
    /// </summary>
    public static class CardIcons
    {
        public const string Nodes = @"<svg width=""20"" height=""20"" viewBox=""0 0 24 24"" fill=""none"" stroke=""currentColor"" stroke-width=""2""><rect x=""2"" y=""3"" width=""20"" height=""14"" rx=""2""/><line x1=""8"" y1=""21"" x2=""16"" y2=""21""/><line x1=""12"" y1=""17"" x2=""12"" y2=""21""/></svg>";
        public const string Cpu = @"<svg width=""20"" height=""20"" viewBox=""0 0 24 24"" fill=""none"" stroke=""currentColor"" stroke-width=""2""><rect x=""4"" y=""4"" width=""16"" height=""16"" rx=""2""/><rect x=""9"" y=""9"" width=""6"" height=""6""/><line x1=""9"" y1=""1"" x2=""9"" y2=""4""/><line x1=""15"" y1=""1"" x2=""15"" y2=""4""/><line x1=""9"" y1=""20"" x2=""9"" y2=""23""/><line x1=""15"" y1=""20"" x2=""15"" y2=""23""/><line x1=""20"" y1=""9"" x2=""23"" y2=""9""/><line x1=""20"" y1=""14"" x2=""23"" y2=""14""/><line x1=""1"" y1=""9"" x2=""4"" y2=""9""/><line x1=""1"" y1=""14"" x2=""4"" y2=""14""/></svg>";
        public const string Memory = @"<svg width=""20"" height=""20"" viewBox=""0 0 24 24"" fill=""none"" stroke=""currentColor"" stroke-width=""2""><path d=""M6 19v-14a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v14""/><path d=""M6 9h12""/><path d=""M6 15h12""/><path d=""M2 19h20""/></svg>";
        public const string Storage = @"<svg width=""20"" height=""20"" viewBox=""0 0 24 24"" fill=""none"" stroke=""currentColor"" stroke-width=""2""><ellipse cx=""12"" cy=""5"" rx=""9"" ry=""3""/><path d=""M21 12c0 1.66-4 3-9 3s-9-1.34-9-3""/><path d=""M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5""/></svg>";
        public const string Dollar = @"<svg width=""20"" height=""20"" viewBox=""0 0 24 24"" fill=""none"" stroke=""currentColor"" stroke-width=""2""><line x1=""12"" y1=""1"" x2=""12"" y2=""23""/><path d=""M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6""/></svg>";
        public const string Apps = @"<svg width=""20"" height=""20"" viewBox=""0 0 24 24"" fill=""none"" stroke=""currentColor"" stroke-width=""2""><rect x=""3"" y=""3"" width=""7"" height=""7""/><rect x=""14"" y=""3"" width=""7"" height=""7""/><rect x=""14"" y=""14"" width=""7"" height=""7""/><rect x=""3"" y=""14"" width=""7"" height=""7""/></svg>";
    }
}
